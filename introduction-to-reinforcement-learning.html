<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Basics of Reinforcement Learning: Part I - The NLP Student&#x27;s Blog</title><meta name="description" content="Welcome! In this article, we will be going over the fundamentals of reinforcement learning. We will discuss what reinforcement learning is, how agents learn from rewards and experiences, what policies and value functions are, and how to model environments in a Markov decision process step-by-step."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://thenlpstudent.github.io/introduction-to-reinforcement-learning.html"><link rel="alternate" type="application/atom+xml" href="https://thenlpstudent.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://thenlpstudent.github.io/feed.json"><meta property="og:title" content="Basics of Reinforcement Learning: Part I"><meta property="og:image" content="https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400.jpg"><meta property="og:image:width" content="314"><meta property="og:image:height" content="314"><meta property="og:site_name" content="The NLP Student's Blog"><meta property="og:description" content="Welcome! In this article, we will be going over the fundamentals of reinforcement learning. We will discuss what reinforcement learning is, how agents learn from rewards and experiences, what policies and value functions are, and how to model environments in a Markov decision process step-by-step."><meta property="og:url" content="https://thenlpstudent.github.io/introduction-to-reinforcement-learning.html"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@studentnlp"><meta name="twitter:title" content="Basics of Reinforcement Learning: Part I"><meta name="twitter:description" content="Welcome! In this article, we will be going over the fundamentals of reinforcement learning. We will discuss what reinforcement learning is, how agents learn from rewards and experiences, what policies and value functions are, and how to model environments in a Markov decision process step-by-step."><meta name="twitter:image" content="https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400.jpg"><link rel="shortcut icon" href="https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400-2.jpg" type="image/png"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--logo-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://thenlpstudent.github.io/assets/css/style.css?v=8ac49514f3b5a54ab40b9772cb61e8d3"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://thenlpstudent.github.io/introduction-to-reinforcement-learning.html"},"headline":"Basics of Reinforcement Learning: Part I","datePublished":"2021-10-16T12:45","dateModified":"2021-10-21T07:51","image":{"@type":"ImageObject","url":"https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400.jpg","height":314,"width":314},"description":"Welcome! In this article, we will be going over the fundamentals of reinforcement learning. We will discuss what reinforcement learning is, how agents learn from rewards and experiences, what policies and value functions are, and how to model environments in a Markov decision process step-by-step.","author":{"@type":"Person","name":"The NLP Student","url":"https://thenlpstudent.github.io/authors/chirath-nissanka/"},"publisher":{"@type":"Organization","name":"The NLP Student","logo":{"@type":"ImageObject","url":"https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400.jpg","height":314,"width":314}}}</script><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://thenlpstudent.github.io/"><img src="https://thenlpstudent.github.io/media/website/jkHsBbG9_400x400.jpg" alt="The NLP Student&#x27;s Blog" width="314" height="314"></a></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2021-10-16T12:45">October 16, 2021</time></div><h1>Basics of Reinforcement Learning: Part I</h1><div class="post__meta post__meta--author"><a href="https://thenlpstudent.github.io/authors/chirath-nissanka/" class="feed__author invert">The NLP Student</a></div></div></header></div><div class="wrapper post__entry"><p>Welcome! In this article, we will be going over the fundamentals of reinforcement learning. We will discuss what reinforcement learning is, how agents learn from rewards and experiences, what policies and value functions are, and how to model environments in a Markov decision process step-by-step.</p><div class="post__toc"><h3>Table of Contents</h3><ul><li><a href="#mcetoc_1fickllfsg7">What is Reinforcement Learning (RL)? </a><ul><li><a href="#mcetoc_1fickllfsg8">What is a reward? </a></li><li><a href="#mcetoc_1fickllfsg9">The Reward Hypothesis </a></li></ul></li><li><a href="#mcetoc_1fickllfsga">Components in Reinfocement learning</a><ul><li><a href="#mcetoc_1fickllfsgb">The Agent and the Enviroment  </a></li><li><a href="#mcetoc_1fickllfsgc">What is the Markov State?</a></li><li><a href="#mcetoc_1ficm0ep4ij">Returns, Epsoides and Continuous Tasks  </a></li><li><a href="#mcetoc_1fie1hfh3oq">What are value functions and policies?  </a></li></ul></li><li><a href="#mcetoc_1fickqocai8">The Markov Decision Process (MDP)</a><ul><li><a href="#mcetoc_1fickllfsgf">The Value Function </a></li><li><a href="#mcetoc_1fickllfsgg">The Action-Value Function</a></li></ul></li><li><a href="#mcetoc_1fickllfsgk">Solving the MDP</a><ul><li><a href="#mcetoc_1fickqocaib">The optimal value and action-value function</a></li></ul></li><li><a href="#mcetoc_1fif6had5p3">Grid world Example </a></li><li><a href="#mcetoc_1fie5fapjov">References </a></li></ul></div><h2 id="mcetoc_1fickllfsg7">What is Reinforcement Learning (RL)? </h2><p>Reinforcement learning is a learning process in which agents learn through interacting with the environment and learn to take actions in a way that maximizes its reward signal. The reward signal is given by the environment depending on how well the agent performed in that environment. <br><br>Reinforcement learning is a computational approach that learns from interaction with an environment. The goal of a reinforcement learning agent is to maximize a numerical reward signal. </p><h3 id="mcetoc_1fickllfsg8">What is a reward? </h3><p>A reward is a simple number given to the agent by the environment each time the agent interacts with the environment. The agent's goal is to maximize then the total amount of reward it receives, which means that the agent needs to maximize the cumulative reward in the long term, not the immediate reward in the short term. </p><h3 id="mcetoc_1fickllfsg9">The Reward Hypothesis </h3><p>The reward hypothesis states that an RL agent's goal is to maximize the expected value of the received scalar signal's cumulative reward. <br><br>Therefore, reinforcement learning gets based on learning methods that maximize the total cumulative reward by taking actions that help reach this goal.</p><h2 id="mcetoc_1fickllfsga">Components in Reinfocement learning</h2><p>The two main components in any reinforcement learning-based algorithm are known as the agent and the environment.</p><h3 id="mcetoc_1fickllfsgb">The Agent and the Enviroment  </h3><p>An agent is a learner and the decision-maker inside an environment. The agent observes the environment and takes action, which is how the agent interacts with the environment. The environment then gives a reward to that agent based on the agent's action at that particular time and situation. <br><br>Everything that is outside of the agent is known as the environment.</p><h3 id="mcetoc_1fickllfsgc">What is the Markov State?</h3><p>In RL, understanding the concept of a state is vital. The state is the information that we use to determine what might happen next. Simply put, the state is a function of history. <br><br>The agent has its state, in which case the agent's state is the function of the agent's history and experiences collected by interacting with the environment.</p><p>The environment also has its state, known as the environment state. <br><br>The agent's or the environment's state is a <strong>Markov state</strong> if the current state is independent of the past. This is because the past information (history) gets derived from the current state. Therefore the state doesn't depend on history. <br><br><strong>"The future is independent of the past given the present"</strong> - and future states can be computed from the current state, and the history can be discarded. </p><p>Suppose the agent can access the environment state. In that case, the mathematical model of the RL problem is known as a fully observable Markov decision process, whereas if the agent cannot access the state of the environment, then it's known as a partially observable Markov decision process. </p><h3 id="mcetoc_1ficm0ep4ij">Returns, Epsoides and Continuous Tasks  </h3><p>The agent's goal is to maximize the total cumulative reward it receives from the environment over time. <br><br>To understand more about the return, we formalize it as follows. This is the basic form of the expected return, which is just the sum of all rewards gathered till the agent reaches the terminal state of the environment (last state of interaction with the environment) from some timestep t. Capital T denotes the final timestep.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/returneq.PNG" alt="" width="375" height="61" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/returneq-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/returneq-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/returneq-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/returneq-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/returneq-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/returneq-2xl.PNG 1600w"></figure><p>Depending on the environment, the agent can work in episodic tasks or continuing tasks.</p><p><br>An episodic task ends at a specific terminal state S+ with different rewards for different outcomes. (All nonterminal states denoted as S.)</p><p>E.g., winning and losing a game of chess, the next episode or next game begins independently of how the previous game ended) The terminal state ends, and the environment resets back into a starting state. </p><p><br>Continous tasks don't have a terminal state. Therefore they go on without a limit. Here taking the total cumulative reward is tricky because the total cumulative reward will be T = ∞.  <br><br>Now we introduce a notation known as the discount factor, a value between 0 and 1. This is so that in continuous environments, the total cumulative reward would not be ∞. <br>If we set the discount factor closer to 0, the agent tends to try and optimize to get higher immediate rewards. On the other hand, if the discount factor is closer to 1, the agent looks ahead to long-term rewards.</p><p>Therefore the agent now tries to select actions that maximize the sum of the discounted rewards (discounted return) it receives from timestep t onwards. So at each state, the agent tries to pick the best action at timestep t that maximizes the expected discounted return:</p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/returnmodified.PNG" alt="" width="522" height="66" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/returnmodified-2xl.PNG 1600w"></figure><p>In the following manner, the current expected discounted return at timestep t relates with the future discounted return at time step t+1. <br><br>Thus, the current expected discounted return is the immediate reward at timestep t plus the discounted expected return at time step t+1.</p><figure class="post__image post__image--center"><img loading="lazy" style="outline: 3px solid rgba(var(--primary-color-rgb), 0.55)  !important;" src="https://thenlpstudent.github.io/media/posts/2/returnwhole.PNG" alt="" width="408" height="100" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/returnwhole-2xl.PNG 1600w"></figure><h3 id="mcetoc_1fie1hfh3oq">What are value functions and policies?  </h3><p>Two other essential concepts in Reinforcement Learning are the value function and the policy function of an RL agent. <br><br>The value function of an RL agent describes how 'good' a state is in the long run.<br><br>It's a function that maps a state to a value that describes how much total expected discounted return the agent would get if the agent takes actions starting from that given state.<br><br>The policy is a function that maps a state with a given action. <br><br>Next, it describes how the behavior of the agent would be in the environment. Finally, it defines a way in which the agent would interact with the environment.<br>The policy function can either be discrete or stochastic, in the sense that it can map to certain actions based on an argmax function, where it picks the action that has the highest return (a greedy policy), or picks an action based on a probabilistic distribution.</p><h2 id="mcetoc_1fickqocai8">The Markov Decision Process (MDP)</h2><p>The Markov Decision Process is a classic formalization of sequential decision making, where actions influence the immediate reward at time step t and future states those actions and the rewards at those future states. <br><br>The MDP process formalizes and helps us derive equations on dealing with the trade-off between immediate and delayed rewards. </p><p>There are two types of values that we estimate by using an MDP, so that we can better deal with the immediate and delayed reward trade-off. <br><br>We estimate the optimal value function that gives each state S's best possible value given optimal action selections. <br><br>We also estimate the optimal action-value function, which takes in as arguments the action and the state the agent is in and gives how good of an action that action is depending on the state. </p><p>Estimating these state-dependent quantities is essential to accurately assign credit to the agent's actions in the environment to make decisions better to effectively trade-off between immediate and delayed rewards. <br><br>The agent would observe the current state at time step t and get the current reward from transitioning into that state. Then, the state would take action, which hopefully maximizes the discounted return for the next timestep. </p><p>The environment would process this action if the environment would produce the next state and reward the agent for moving into the new state. </p><p><br>This is how the agent and the environment interact with each other. The agent's goal is to behave optimally in this environment, which is done by maximizing the total discounted return over time. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/Group-5-2.png" alt="" width="556" height="241" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-xs.png 300w, https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-sm.png 480w, https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-md.png 768w, https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-lg.png 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-xl.png 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/Group-5-2-2xl.png 1600w"></figure><p>While interacting with the environment, this would be the sequential history the agent goes through.</p><p>For example, the agent starts at timestep 0, observes the state, takes action, and obtains a reward, and this cycle repeats. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/bellman_1.PNG" alt="" width="433" height="49" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_1-2xl.PNG 1600w"></figure><p>The MDP describes the probability in which the agent transitions from one state to the next.</p><p>The likelihood that given the agent is in a given state 's' and takes action' a', the likelihood that that agent would end up in a new state " s' " and gets a reward 'r' is described as follows, </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/bellman_2.PNG" alt="" width="588" height="56" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_2-2xl.PNG 1600w"></figure><figure class="post__image post__image--center">The probability in taking action 'a' from state 's' and transitioning to state " s' " is the summation for all rewards in set R (all possible reward values in the MDP), and their transition probability of starting at state 's', taking action 'a', transitioning to state " s' " and getting probability 'r' for all rewards in set R.<br><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/bellman_5.PNG" alt="" width="710" height="103" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_5-2xl.PNG 1600w"></figure><p>The expected reward for choosing action a from state s can be described as the summation of all rewards in R weighted over all the state transition probabilities from state 's', taking action 'a', landing in the state " s' " and getting a reward 'r' afterward. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/bellman_6.PNG" alt="" width="670" height="77" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_6-2xl.PNG 1600w"></figure><p>The expected reward the agent will receive at the current state " s' " given that the previous state and action was 's' and 'a', is the summation of all rewards R, weighted by the total probability of transitioning from state 's' to " s' " by taking action 'a' over the probability of transitioning from state 's' to " s' " by taking action 'a' and getting a specific reward 'r' in R.  </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/bellman_7.PNG" alt="" width="737" height="78" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellman_7-2xl.PNG 1600w"></figure><p>Here it shows that the probability of transitioning from all states " s' " and getting all rewards 'r' from those states given that the agent was in state 's' and takes action 'a' sums to 1. This shows that the function 'p' specifies a probability distribution for each choice of state 's' and action 'a'. </p><figure class="post__image post__image--center"><img loading="lazy" style="font-size: 18.4px; outline: 3px solid rgba(var(--primary-color-rgb), 0.55)  !important;" src="https://thenlpstudent.github.io/media/posts/2/bellamn_3.PNG" alt="" width="521" height="81" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/bellamn_3-2xl.PNG 1600w"></figure><h3 id="mcetoc_1fickllfsgf">The Value Function </h3><p><span data-preserver-spaces="true">The value function defines how good it is to be in a particular state. </span></p><p><span data-preserver-spaces="true">This means it gives the total expected discounted reward that is possible to receive, given that the agent continues to take actions from that state onward. </span></p><p><span data-preserver-spaces="true">The value function depends upon the state, and the policy the agent follows since the selection of actions from state 's' onwards depends on the agent's policy or behavior. </span></p><p><span data-preserver-spaces="true">The below equation shows that the value function when the agent uses a given policy </span><strong><span data-preserver-spaces="true">π </span></strong><span data-preserver-spaces="true">and starts at state s, is equivalent by the MDP to the expectation of the total discounted return from timestep t onwards, given that the agent currently at timestep t is on the state 's'.</span></p><p><span data-preserver-spaces="true">Afterward, we can expand the definition of the total discounted return and show that this is true for all states in the MDP. </span></p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/v_policy_s.PNG" alt="" width="613" height="68" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s-2xl.PNG 1600w"></figure><p>We can also evaluate this expectation as follows by the recursive defintion of the total discounted return.</p><p>Here it shows that the value function is the summation of all actions that can be made by the agent, and the probability the agent will choose that action  is weighted by the sum the transitioning probabiltieis of all states and rewards from state 's' by taking action 'a' multiplied by the immediate reward of the given transitioning probabilities plus the discounted value of the value function under policy <strong>π </strong>for the next state " s' ".</p><p> </p><figure class="post__image post__image--center"><img loading="lazy" style="font-size: 18.4px; outline: 3px solid rgba(var(--primary-color-rgb), 0.55)  !important;" src="https://thenlpstudent.github.io/media/posts/2/v_policy_s_s.PNG" alt="" width="567" height="173" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/v_policy_s_s-2xl.PNG 1600w"></figure><div> </div><h3 id="mcetoc_1fickllfsgg">The Action-Value Function</h3><p>The action-value function maps a state and an action to show how much expected total discounted return the agent will receive from the environment if the agent starts at state 's' and takes action 'a' from that time until the environment terminates. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/q_policy_s_a.PNG" alt="" width="630" height="87" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/q_policy_s_a-2xl.PNG 1600w"></figure><h2 id="mcetoc_1fickllfsgk">Solving the MDP</h2><p>Solving the MDP entails that we find the optimal value function or the optimal action-value function, which can be derived from the optimal value function in the MDP and allowing the agent to pick the best action that gives the highest possible action-value for the state that the agent is currently at timestep t. </p><h3 id="mcetoc_1fickqocaib">The optimal value and action-value function</h3><p>The optimal value function is the maximum value that can be obtained from the state s given under the policy, which enables the agent to choose such actions from that state onwards which maximizes the expected total discounted return from that state onwards. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/optimal_val_policy.PNG" alt="" width="230" height="47" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_val_policy-2xl.PNG 1600w"></figure><p>The optimal action-value function is the maximum action value obtained from state 's' by taking action 'a' under the policy that enables the agent to choose such actions from that state and action onwards, which maximizes the expected total discounted return from that state, action pair onwards. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/optimal_q_value.PNG" alt="" width="245" height="42" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/optimal_q_value-2xl.PNG 1600w"></figure><p>The optimal action-value function can be written in terms of the optimal value function as the expectation of the immediate reward plus the discounted optimal value of the next state given that the current state is 's' and the action taken from that state is action 'a'. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/q_optimal_s_a_expe-2.PNG" alt="" width="417" height="35" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_s_a_expe-2-2xl.PNG 1600w"></figure><p>The recurrence relation of the optimal value function is the value of the maximum action 'a' that can be taken which is a summation of all the states and rewards in the sets S and R of the MDP, weighted by the transition probability of moving to those states obtaining those rewards multiplied by the immediate reward plus the discounted optimal value of the next state the agent would move to. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/big_equ.PNG" alt="" width="447" height="208" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/big_equ-2xl.PNG 1600w"></figure><p>The recurrence relation of the optimal action-value function is the sum of all states and rewards in S and R of the MDP, weighted by the transition probability multiplied by the immediate reward 'r' plus the discounted best action-value function of the next state the agent would move into by taking action " a' " from that state. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/q_optimal_stup.PNG" alt="" width="523" height="109" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/q_optimal_stup-2xl.PNG 1600w"></figure><h2 id="mcetoc_1fif6had5p3">Grid world Example </h2><p>In this example, the RL agent has to traverse the following grid world, and any action that doesn't involve traversing from A to A' or B to B' gives a reward of -1. Otherwise, a reward of +10 and +5 is given if the agent gets teleported from A to A' or B to B'.</p><p> <br>The agent can only take one step in north, east, south, and west. </p><p>While the agent updates its value function by interacting and moving in this grid world environment, the value function over time would update as shown in the below table.</p><p>It shows how much discounted total return each cell would give the agent over the long run. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/policyexample.PNG" alt="Reinforcement Learning: 2nd Edition (Finite Markov Decision Processes)" width="508" height="182" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/policyexample-2xl.PNG 1600w"><figcaption>Reinforcement Learning: 2nd Edition (Finite Markov Decision Processes)</figcaption></figure><p>Once the agent finds the optimal policy that makes the agent optimize on getting the best possible discounted returns from this grid world, the value function would converge to the optimal value function. </p><p><br>By acting greedily upon the optimal value function, we find the optimal policy function.</p><p>If the agent chooses actions that get to better states (cells) with a higher value than the other states accessible from the current state the agent is in, the agent has successfully found the best policy to act optimally in this grid world in the below diagram. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://thenlpstudent.github.io/media/posts/2/gridworld2.PNG" alt="" width="779" height="270" sizes="(max-width: 48em) 100vw, 768px" srcset="https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-xs.PNG 300w, https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-sm.PNG 480w, https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-md.PNG 768w, https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-lg.PNG 1024w, https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-xl.PNG 1360w, https://thenlpstudent.github.io/media/posts/2/responsive/gridworld2-2xl.PNG 1600w"><figcaption>Reinforcement Learning: 2nd Edition (Finite Markov Decision Processes)</figcaption></figure><p><span data-preserver-spaces="true">That brings us to the end of the basics of reinforcement learning part 1.</span></p><p><span data-preserver-spaces="true">This would be a 3 part series. In the second post, we will be going over Multi-armed bandits, an interesting problem in Reinforcement Learning. In the 3rd and final post, we will be going over finding the optimal value function solving the MDP using Dynamic Programming. </span></p><p><span data-preserver-spaces="true">Stay tuned, and follow me on Twitter </span><a target="_blank" href="https://twitter.com/intent/user?screen_name=studentnlp" class="editor-rtfLink" rel="noopener"><span data-preserver-spaces="true">@studentnlp</span></a><span data-preserver-spaces="true">, so you don't miss any new posts. </span></p><p><span data-preserver-spaces="true">Cheers! </span></p><h2 id="mcetoc_1fie5fapjov">References </h2><ul><li><span class="ILfuVd"><span class="hgKElc">Sutton, R.S. &amp; Barto, A.G., 2018. Reinforcement learning: An introduction, MIT press.</span></span></li><li><a href="https://www.youtube.com/playlist?list=PLqYmG7hTraZDM-OYHWgPebj2MfCFzFObQ" target="_blank" rel="noopener noreferrer">David Silver "Introduction to Reinforcement Learning" DeepMind 2015</a> </li></ul><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on October 21, 2021</p><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://thenlpstudent.github.io/authors/chirath-nissanka/" class="invert" rel="author">The NLP Student</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://thenlpstudent.github.io/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://thenlpstudent.github.io/transformers-and-attention.html" class="invert post__nav-link" rel="prev"><span>Previous</span> The Transformer Explained</a></div><div class="post__nav-next"><a href="https://thenlpstudent.github.io/the-multi-armed-bandits-problem.html" class="invert post__nav-link" rel="next"><span>Next</span> The Multi-Armed Bandit Problem  </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://thenlpstudent.github.io/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav></main><footer class="footer"><div class="footer__copyright"><p>Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></p></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://thenlpstudent.github.io/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://thenlpstudent.github.io/assets/js/scripts.min.js?v=f4c4d35432d0e17d212f2fae4e0f8247"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>